

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Introduction : Teachble Machine &mdash; AI_beginner_course 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/SierraBASE.png"/>
  

  
  

  
    <link rel="canonical" href="https://sierrabaselab.github.io/AI_beginner_course/text/#2_Image_Classification.html" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction : Jetson-Inference" href="%233_Jetson_Opensource.html" />
    <link rel="prev" title="Install : Prerequisies and Dependencies" href="%231_Get_Started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> AI_beginner_course
          

          
            
            <img src="../_static/SierraBASE.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="%231_Get_Started.html">Install : Prerequisies and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="%231_Get_Started.html#install-tensorflow">Install : tensorflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="%231_Get_Started.html#download-project">Download : Project</a></li>
</ul>
<p class="caption"><span class="caption-text">Image_classifciation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction : Teachble Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="#how-to-train">1. How to train</a></li>
<li class="toctree-l1"><a class="reference internal" href="#inference-and-results">2. Inference and Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="#introduction-mnist">Introduction : MNIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="#training-phase">1. Training Phase</a></li>
<li class="toctree-l1"><a class="reference internal" href="#data-preparation">2. Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#inference">3. Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="#faq">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced_AI:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="%233_Jetson_Opensource.html">Introduction : Jetson-Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="%233_Jetson_Opensource.html#build-models">1. Build models</a></li>
<li class="toctree-l1"><a class="reference internal" href="%233_Jetson_Opensource.html#let-s-run-some-files">2. Let’s Run some files</a></li>
<li class="toctree-l1"><a class="reference internal" href="%233_Jetson_Opensource.html#introduction-object-tracking-udt">Introduction : Object Tracking(UDT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="%233_Jetson_Opensource.html#let-s-run-udt-py">0. Let’s run UDT.py</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AI_beginner_course</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Introduction : Teachble Machine</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/text/" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-teachble-machine">
<h1>Introduction : Teachble Machine<a class="headerlink" href="#introduction-teachble-machine" title="Permalink to this headline">¶</a></h1>
<p><img alt="introduction1" src="../_images/Introduce1.png" /></p>
<p>This is made by <a class="reference external" href="https://github.com/googlecreativelab">Google CreativeLab</a> Team. <a class="reference external" href="https://teachablemachine.withgoogle.com/">Teachable Machine</a> is a web-based tool that makes creating machine learning models fast, easy, and accessible to everyone. It trains a model to recognize your own</p>
<ul class="simple">
<li><p>images</p></li>
<li><p>sounds</p></li>
<li><p>poses.</p></li>
</ul>
<p><img alt="Introduction2" src="../_images/Introduce2.png" /></p>
<p>We can train models by just clicking the mouse button. <strong>Therefore, expertise and coding skill are not required.</strong> For instance, I’ll show you two characters(figures) from “ONE PIECE”</p>
<ul class="simple">
<li><p>Mihawk</p></li>
<li><p>Shanks</p></li>
</ul>
<p>The figrues’ information is given below. Let’s try to <strong>classify images.</strong></p>
</div>
<div class="section" id="how-to-train">
<h1>1. How to train<a class="headerlink" href="#how-to-train" title="Permalink to this headline">¶</a></h1>
<p>It’s so easy. Juet follow them. Whatever you picked any projects, it is not a problem. But, to follow this project, I recommend <strong>“to choose Image Projects”</strong>. You can see the above picture.</p>
<ol>
<li><p>Push “Webcam” Button. (You may modify the class name.)</p>
<p><img alt="push_them" src="../_images/push_webcam.png" /></p>
</li>
<li><p>Just Keep pushing “Hold a Record Button”. Then, You can collect your datasets fast.</p>
<p><img alt="Keep Push" src="../_images/Shanks_Labeling.gif" /></p>
<p><img alt="Keep_Push2" src="../_images/Mihawk_Labeling.gif" /></p>
</li>
<li><p>If you’ve fininshed to set Image Datasets, then push the “Train Model” Button.</p>
<p><img alt="Push_train" src="../_images/train_model.png" /></p>
</li>
</ol>
<p>That’s all.</p>
</div>
<div class="section" id="inference-and-results">
<h1>2. Inference and Results<a class="headerlink" href="#inference-and-results" title="Permalink to this headline">¶</a></h1>
<p>You can view your trained results. Moreover you can download your datasets and model.</p>
<p><img alt="Output" src="../_images/output.gif" /></p>
<p>The picture given below is when you clicked the button “Export model”. From “Tensorflow.js” banner, you can refer to url containing model and datasets. Only in “Tensorflow” banner, you can test simply python codes. You need a tensorflow modules. “Tensorflow Lite” supports to mobile or other edge devices.</p>
<p><img alt="Output" src="../_images/Download_Mymodel.png" /></p>
<p>I also made <code class="docutils literal notranslate"><span class="pre">{DL_course/Image_Classficiation/Cam_Classify.py}</span></code> for you. So you can also simulate this file. <strong>If you want to experiment your own datasets, then overwrite <code class="docutils literal notranslate"><span class="pre">labels.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">keras_model.h5</span></code> from <code class="docutils literal notranslate"><span class="pre">converted_keras.zip</span></code> file.</strong></p>
<p>To proceed this course, simply check this :</p>
<p><em>You need to set directories on <code class="docutils literal notranslate"><span class="pre">{your_directory}/AI_beginner_course/DL_course/Image_Classification</span></code></em></p>
<p>So, don’t forget below line :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can skip, if your current direcory is on &quot;Image_Classification&quot;.</span>
$ <span class="nb">cd</span> AI_beginner_course/DL_course/Image_Classification/
</pre></div>
</div>
<p>If you’ve finished, try this code :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ python3 Cam_Classify.py
</pre></div>
</div>
<p>If you have <code class="docutils literal notranslate"><span class="pre">TLS_block</span></code> error, then please see this <a class="reference external" href="#FAQ">line</a>. You can escape by pushing <code class="docutils literal notranslate"><span class="pre">q</span></code> key!!. The FPS of this program will be much low, beacuse Teachable Machine supports GPU remotely. Despite of this, it may operate well.</p>
<p>Anyway, you can see more details, such as model parameters, model loss, accuracy and so on in “Teachable Machine” site…</p>
</div>
<div class="section" id="introduction-mnist">
<h1>Introduction : MNIST<a class="headerlink" href="#introduction-mnist" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://commons.wikimedia.org/wiki/File:MnistExamples.png"><img src="https://upload.wikimedia.org/wikipedia/commons/2/27/MnistExamples.png"></a></p>
<p>MNIST(Modified National Institute of Standards and Technology database) is the database of handwritten digits, (<a class="reference external" href="http://yann.lecun.com/exdb/mnist/">visit for this page</a>), which obtains 60,000 training examples and 10,000 test examples. It is basically used for Deep Learning. We aim to classify the numbers from 0 to 9. Furthermore, we test for our handmade digits, with our made Deep Learning models.</p>
</div>
<div class="section" id="training-phase">
<h1>1. Training Phase<a class="headerlink" href="#training-phase" title="Permalink to this headline">¶</a></h1>
<p>See this <a class="reference external" href="https://colab.research.google.com/drive/1cDfsA_no_bLmv5S7217nL0UcEd2nZ1Hr?usp=sharing">link(colab)</a></p>
<p>We trained 60,000 numbers of images(Open Dataset, MNIST).</p>
<p>You may remember the only <code class="docutils literal notranslate"><span class="pre">mnist_99acc_model.h5</span></code> file. (You can <a class="reference external" href="https://docs.google.com/uc?export=download&amp;id=1tTfB7C4Imavg_ppIwXk0DG-cRkA5P_mt">Download here</a>)</p>
<p>It helps to load model paramters easily.</p>
<p>(In this course, you can train in colab with GPU for free. It is too hard to train mnist datasets with Jetson Nano toolkits, because of low memories. <strong>I strongly recommend to train with devices having GPUs.</strong>)</p>
</div>
<div class="section" id="data-preparation">
<h1>2. Data Preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline">¶</a></h1>
<p>See this <a class="reference external" href="https://colab.research.google.com/drive/18eUHkOg5jy2YgugphupEjhuAMmem56uD?usp=sharing">link(colab)</a></p>
<p>This helps your handmade datasets to become suitable inputs of this model.</p>
<p>I wrote this codes about Data Preprocessing.</p>
<ul>
<li><p>How to run? (Your directories must be on <code class="docutils literal notranslate"><span class="pre">Image_Classification/</span></code>)</p>
<ol>
<li><p>Prepare only a written number (0 ~ 9)</p>
<p>There are some rules. Keep in mind!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">The</span> <span class="n">written</span> <span class="n">number</span> <span class="n">should</span> <span class="n">be</span> <span class="n">enough</span> <span class="n">large</span> <span class="p">(</span><span class="n">Recommend</span> <span class="n">to</span> <span class="n">take</span> <span class="n">over</span> <span class="n">the</span> <span class="mi">60</span><span class="o">%</span> <span class="n">area</span><span class="p">)</span>
<span class="mf">2.</span> <span class="n">The</span> <span class="n">written</span> <span class="n">number</span> <span class="n">should</span> <span class="n">be</span> <span class="n">the</span> <span class="n">only</span> <span class="n">one</span> <span class="n">number</span>
  <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">never</span> <span class="n">recognize</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mf">58.</span><span class="o">..</span> <span class="n">Only</span> <span class="n">allow</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="o">.</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span>
<span class="mf">3.</span> <span class="n">The</span> <span class="n">more</span> <span class="n">Pen</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">the</span> <span class="n">better</span><span class="o">.</span>
<span class="mf">4.</span> <span class="n">The</span> <span class="n">background</span> <span class="p">(</span><span class="n">paper</span><span class="p">)</span> <span class="n">should</span> <span class="n">be</span> <span class="n">white</span><span class="o">.</span> <span class="n">Don</span><span class="s1">&#39;t shade the light by cameras.</span>
</pre></div>
</div>
<p>For example, there is a good case</p>
<p><img src="../MNIST/3.jpg" width="100px" height="50px"> <img src="../MNIST/7.jpg" width="100px" height ="50px"> <img src="../MNIST/8.jpg" width="100px" height ="50px"> <img src="../MNIST/9.jpg" width="100px" height ="50px"></p>
<p>Then, these result will be</p>
<p><img alt="index" src="../_images/index.png" /></p>
</li>
<li><p>Now, let’s Run “Data_Preparation.py”</p>
<p>Note that we don’t care what the file names are. You only need any “.jpg” files</p>
<p>At, <code class="docutils literal notranslate"><span class="pre">{your_directory}AI_beginner_course/DL_course/Image_Classification}</span></code>,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ tree .
.
├── Data_Preparation.py
├── Test_0.jpg
├── Test_1.jpg
├── Test_2.jpg
└── Test_3.jpg

<span class="m">0</span> directories, <span class="m">5</span> files
</pre></div>
</div>
<p>Then <code class="docutils literal notranslate"><span class="pre">*.jpg</span></code> files will convert to <code class="docutils literal notranslate"><span class="pre">Preprocessed_i.jpg</span></code> files by running this py :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ python3 Data_Preparation.py
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ tree .
.
├── Data_Preparation.py
├── PreProcessed
│   ├── Preprocessed_0.jpg
│   ├── Preprocessed_1.jpg
│   ├── Preprocessed_2.jpg
│   └── Preprocessed_3.jpg
├── Test_0.jpg
├── Test_1.jpg
├── Test_2.jpg
└── Test_3.jpg

<span class="m">1</span> directory, <span class="m">9</span> files
</pre></div>
</div>
</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="inference">
<h1>3. Inference<a class="headerlink" href="#inference" title="Permalink to this headline">¶</a></h1>
<p>See this <a class="reference external" href="https://colab.research.google.com/drive/18eUHkOg5jy2YgugphupEjhuAMmem56uD?usp=sharing">link(colab)</a> (Same as 2)</p>
<p>You can test on your written numbers at <code class="docutils literal notranslate"><span class="pre">AI_beginner_course/Image_Classification/Inference.py</span></code>.
Your written and resized <code class="docutils literal notranslate"><span class="pre">PreProcessed/Preprocessed_i.jpg</span></code> files will be evaluated from saved <code class="docutils literal notranslate"><span class="pre">Image_Classification/mnist_99acc_model.h5</span></code> Anyway,</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ python3 Inference.py

<span class="o">(</span>omit<span class="o">)</span>

In PreProcessed folder, there are files :
 <span class="o">[</span><span class="s1">&#39;PreProcessed/Preprocessed_0.jpg&#39;</span>, <span class="s1">&#39;PreProcessed/Preprocessed_1.jpg&#39;</span>, <span class="s1">&#39;PreProcessed/Preprocessed_2.jpg&#39;</span>, <span class="s1">&#39;PreProcessed/Preprocessed_3.jpg&#39;</span><span class="o">]</span> 
	
<span class="o">(</span>omit<span class="o">)</span>

From PreProcessed/Preprocessed_0.jpg, We predicted :  <span class="o">[</span><span class="m">3</span><span class="o">]</span> .

From PreProcessed/Preprocessed_1.jpg, We predicted :  <span class="o">[</span><span class="m">7</span><span class="o">]</span> .

From PreProcessed/Preprocessed_2.jpg, We predicted :  <span class="o">[</span><span class="m">8</span><span class="o">]</span> .

From PreProcessed/Preprocessed_3.jpg, We predicted :  <span class="o">[</span><span class="m">4</span><span class="o">]</span> .
</pre></div>
</div>
</div>
<div class="section" id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h1>
<p>Q. I got a problem with : <a id="FAQ"></a></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ImportError: /usr/lib/aarch64-linux-gnu/libgomp.so.1: cannot allocate memory <span class="k">in</span> static TLS block
</pre></div>
</div>
<p>Then, what should I do?</p>
<p>A. Add at shell</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">export</span> <span class="nv">LD_PRELOAD</span><span class="o">=</span>/usr/lib/aarch64-linux-gnu/libgomp.so.1
</pre></div>
</div>
<p>From now on, you’ve checked a simple model training and inference with MNIST!</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="%233_Jetson_Opensource.html" class="btn btn-neutral float-right" title="Introduction : Jetson-Inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="%231_Get_Started.html" class="btn btn-neutral float-left" title="Install : Prerequisies and Dependencies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, SierraBaseLab.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>